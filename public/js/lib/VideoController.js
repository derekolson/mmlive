// Generated by CoffeeScript 1.6.3
/*
 Maintains local and remote video streams
*/


(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  define(['AppController'], function(AppController) {
    var VideoController;
    VideoController = (function() {
      function VideoController() {
        this.videoSuccess = __bind(this.videoSuccess, this);
      }

      VideoController.prototype.init = function() {
        this.remoteVideos = [];
        if (PeerConnection) {
          return rtc.createStream({
            video: true,
            audio: false
          }, this.videoSuccess);
        }
      };

      VideoController.prototype.videoSuccess = function(stream) {};

      VideoController.prototype.videoError = function() {};

      VideoController.prototype.addRemoteStream = function(stream, id) {
        var clone;
        clone = this.cloneVideo('mainVideo', id);
        clone.setAttribute('class', '');
        rtc.attachStream(stream, clone.id);
        this.remoteVideos.push(clone);
        return clone;
      };

      VideoController.prototype.cloneVideo = function(domId, id) {
        var clone, video;
        video = document.getElementById(domId);
        clone = video.cloneNode(false);
        clone.id = 'remote' + id;
        document.getElementById('remoteVideos').appendChild(clone);
        return clone;
      };

      VideoController.prototype.removeVideo = function(id) {
        var video;
        video = document.getElementById('remote' + id);
        if (video) {
          this.remoteVideos.splice(this.remoteVideos.indexOf(video), 1);
          return video.parentNode.removeChild(video);
        }
      };

      return VideoController;

    })();
    return new VideoController();
  });

}).call(this);
